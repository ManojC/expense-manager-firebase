<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../t-button/t-button.html">
<link rel="import" href="../t-input/t-input.html">
<link rel="import" href="../t-text-container/travel-element-styles.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html" />

<!--
A comment describing this element

Example:

    <firebase-poc></firebase-poc>

Example:

    <firebase-poc>
      <h2>Hello firebase-poc</h2>
    </firebase-poc>

@demo demo/index.html
-->

<dom-module id="firebase-poc">
	<template>
	  	<style include="iron-flex"></style>
		<style include="travel-element-styles">
			:host {
                font-family: var(--header-font-family, --primary-font-family);
                font-size: var(--font-14, 14px);
                display: block;
			}

			t-button {
				display: block;
			}
		</style>
		<div class="section-small margine-bottom-large">
			<t-input 
				id="description" 
				class="flex margin-bottom-large" 
				label="First Name"
				value="{{newMessage}}"
				required
				error-message="This field is mandatory.">
			</t-input>
			<t-button 
			    label="Save Data"
			    id="submit"
			    class="primary flex"
			    on-tap="_saveData">
			</t-button>			
		</div>

		<div class="section-small">
			<template id="list" is="dom-repeat" items="[[messages]]">
				<div>[[item]]</div>
			</template>
		</div>
	</template>

	<script>
		(function () {

			'use strict'

			Polymer({

				is: 'firebase-poc',

				properties: {
					messages: {
					  type: Array
					},
				},

				attached: function () {

					// Initialize Firebase
					var config = {
						apiKey: "AIzaSyDh6lvLv6mPWZ6qckcgsG4PkXEuUd12k8w",
						authDomain: "orion8-387b8.firebaseapp.com",
						databaseURL: "https://orion8-387b8.firebaseio.com",
						storageBucket: "",
						messagingSenderId: "397121342906"
					};
					firebase.initializeApp(config);					
				},

				_saveData: function () {

					if (!this.validate()) {
						return;
					}

					if (!this.messages || !this.messages.length) {
						this.messages = [];						
					}

					this.messages = this.messages.concat([this.newMessage]);

					this.newMessage = "";

					this.$.list.render();
				},

				validate: function () {
					return !this.$.submit.disabled && this.$.description.validate();
				}
			});
			
		})();
	</script>
	<script src="https://www.gstatic.com/firebasejs/3.4.1/firebase.js"></script>
</dom-module>
